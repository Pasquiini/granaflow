<form *ngIf="ready && !successMsg"
      [formGroup]="form"
      (ngSubmit)="submit()"
      novalidate
      class="space-y-4">

  <!-- Campo Senha -->
  <div>
    <label class="text-sm font-medium text-gray-700 mb-1 flex items-center gap-1">
      <i class="fa-solid fa-lock text-emerald-600"></i>
      Nova senha
    </label>

    <div class="relative group">
      <input
        type="password"
        formControlName="password"
        placeholder="Digite sua nova senha"
        autocomplete="new-password"
        class="w-full rounded-xl border border-gray-300 px-4 py-3 pr-10 outline-none transition-all duration-200
               focus:border-emerald-600 focus:ring-2 focus:ring-emerald-100
               group-hover:shadow-md group-hover:border-emerald-500
               text-gray-800 bg-white/70 backdrop-blur-sm"
        [class.border-red-500]="form.controls['password'].touched && form.controls['password'].invalid"
      />
      <i class="fa-solid fa-key absolute right-3 top-3.5 text-gray-400 group-hover:text-emerald-600 transition"></i>
    </div>

    <div class="text-sm text-red-600 mt-1"
         *ngIf="form.controls['password'].touched && form.controls['password'].errors">
      <span *ngIf="form.controls['password'].errors['required']">Informe a nova senha.</span>
      <span *ngIf="form.controls['password'].errors['minlength']">Mínimo de 8 caracteres.</span>
    </div>
  </div>

  <!-- Campo Confirmar -->
  <div>
    <label class="text-sm font-medium text-gray-700 mb-1 flex items-center gap-1">
      <i class="fa-solid fa-repeat text-emerald-600"></i>
      Confirmar senha
    </label>

    <div class="relative group">
      <input
        type="password"
        formControlName="confirm"
        placeholder="Confirme sua nova senha"
        autocomplete="new-password"
        class="w-full rounded-xl border border-gray-300 px-4 py-3 pr-10 outline-none transition-all duration-200
               focus:border-emerald-600 focus:ring-2 focus:ring-emerald-100
               group-hover:shadow-md group-hover:border-emerald-500
               text-gray-800 bg-white/70 backdrop-blur-sm"
        [class.border-red-500]="form.errors?.['mismatch'] && form.controls['confirm'].touched"
      />
      <i class="fa-solid fa-check-double absolute right-3 top-3.5 text-gray-400 group-hover:text-emerald-600 transition"></i>
    </div>

    <div class="text-sm text-red-600 mt-1"
         *ngIf="form.errors?.['mismatch'] && form.controls['confirm'].touched">
      As senhas não coincidem.
    </div>
  </div>

  <!-- Botão -->
  <button
    type="submit"
    [disabled]="loading || form.invalid"
    class="w-full py-3 rounded-xl font-semibold text-white transition-all duration-200
           bg-gradient-to-r from-emerald-600 to-teal-600
           hover:from-emerald-700 hover:to-teal-700
           disabled:opacity-60 disabled:cursor-not-allowed shadow-md hover:shadow-lg">
    <ng-container *ngIf="!loading">💾 Salvar nova senha</ng-container>
    <ng-container *ngIf="loading">⏳ Salvando...</ng-container>
  </button>
</form>
